(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{68:function(e,t,n){},69:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n(22),r=n.n(a),s=(n(68),n(69),n(99)),i=n(27),o=n(105),j=n(104),u=n(9),d=n(1),l=function(){var e=Object(u.c)((function(e){return e.user})),t=Object(u.b)(),n=Object(u.c)((function(e){return e.cart})),a=n.reduce((function(e,t){return e+t.qty}),0);Object(c.useEffect)((function(){var e=window.localStorage.getItem("loggedIn");if(e){var n=JSON.parse(e);t({type:"LOGIN",data:{name:n.name,isAdmin:n.isAdmin}})}}),[t]);var r=function(){t({type:"LOGOUT"}),window.localStorage.removeItem("loggedIn")},l=function(){return e.name?Object(d.jsx)(i.LinkContainer,{to:"/",onClick:r,children:Object(d.jsxs)(o.a.Link,{children:[Object(d.jsx)("i",{className:"fas fa-user"}),"Sign out (",e.name,")"]})}):Object(d.jsx)(i.LinkContainer,{to:"/login",children:Object(d.jsxs)(o.a.Link,{children:[Object(d.jsx)("i",{className:"fas fa-user"}),"Sign In"]})})};return Object(d.jsx)("header",{children:Object(d.jsx)(j.a,{bg:"light",expand:"lg",children:Object(d.jsxs)(s.a,{children:[Object(d.jsx)(i.LinkContainer,{to:"/",children:Object(d.jsx)(j.a.Brand,{children:"AbduSouq"})}),Object(d.jsx)(j.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(d.jsx)(j.a.Collapse,{id:"basic-navbar-nav",children:Object(d.jsxs)(o.a,{className:"ms-auto",children:[e.isAdmin?Object(d.jsx)(i.LinkContainer,{to:"/add",children:Object(d.jsxs)(o.a.Link,{children:[Object(d.jsx)("i",{className:"fas fa-plus-square"}),"Add Product"]})}):null,e.name?Object(d.jsx)(i.LinkContainer,{to:"/edit",children:Object(d.jsxs)(o.a.Link,{children:[Object(d.jsx)("i",{className:"fas fa-list"}),"My Products"]})}):null,Object(d.jsx)(i.LinkContainer,{to:"/cart",children:Object(d.jsxs)(o.a.Link,{children:[Object(d.jsx)("i",{className:"fas fa-shopping-cart"}),"Cart (",0===n.length?"":a,")"]})}),Object(d.jsx)(l,{})]})})]})})})},b=n(100),O=n(61),h=function(){return Object(d.jsx)("div",{children:Object(d.jsx)(s.a,{children:Object(d.jsx)(b.a,{children:Object(d.jsx)(O.a,{className:"text-center py-3",children:"Copyright \xa9 AbduSouq"})})})})},x=n(8),f=n.n(x),p=n(14),m=n(17),v=n.n(m),g=n(107),k=function(e){var t=e.rating,n=e.numReviews,c=e.reviewFunc;return Object(d.jsxs)("div",{className:"rating",children:[Object(d.jsxs)("span",{children:[Object(d.jsx)("i",{className:t>=1?"fas fa-star":t>=.5?"fas fa-star-half-alt":"far fa-star",onClick:function(){return c(1)}}),Object(d.jsx)("i",{className:t>=2?"fas fa-star":t>=1.5?"fas fa-star-half-alt":"far fa-star",onClick:function(){return c(2)}}),Object(d.jsx)("i",{className:t>=3?"fas fa-star":t>=2.5?"fas fa-star-half-alt":"far fa-star",onClick:function(){return c(3)}}),Object(d.jsx)("i",{className:t>=4?"fas fa-star":t>=3.5?"fas fa-star-half-alt":"far fa-star",onClick:function(){return c(4)}}),Object(d.jsx)("i",{className:t>=5?"fas fa-star":t>=4.5?"fas fa-star-half-alt":"far fa-star",onClick:function(){return c(5)}})]}),Object(d.jsxs)("span",{children:[n&&n," reviews "]})]})},w=n(11),y=function(e){var t=e.prod;return Object(d.jsx)("div",{children:Object(d.jsxs)(g.a,{className:"my-3 p-3 rounded",children:[Object(d.jsx)(w.Link,{to:"/products/".concat(t._id),children:Object(d.jsx)(g.a.Img,{variant:"top",src:t.image})}),Object(d.jsxs)(g.a.Body,{children:[Object(d.jsx)(w.Link,{to:"/products/".concat(t._id),children:Object(d.jsx)(g.a.Title,{children:Object(d.jsx)("strong",{children:t.name})})}),Object(d.jsx)(g.a.Text,{as:"div",children:Object(d.jsx)(k,{rating:t.rating,numReviews:t.numReviews,reviewFunc:function(){}})}),Object(d.jsx)(g.a.Text,{as:"h3",children:t.price})]})]},t._id)})},I=function(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e.products}));return Object(c.useEffect)((function(){(function(){var t=Object(p.a)(f.a.mark((function t(){var n,c;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.get("/api/products");case 2:n=t.sent,c=n.data,e({type:"INIT",data:c});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("h1",{children:"Latest Products"}),Object(d.jsx)(b.a,{children:t.map((function(e){return Object(d.jsx)(O.a,{sm:12,md:6,lg:4,xl:3,children:Object(d.jsx)(y,{prod:e})},e._id)}))})]})},C=n(30),S=n(6),N=n(101),L=n(108),q=n(102),A=function(e){var t=e.match,n=JSON.parse(window.localStorage.getItem("loggedIn")),c=Object(u.b)(),a=Object(S.k)(),r=Object(u.c)((function(e){return e.products.find((function(e){return e._id===t.params.id}))})),s=function(){var e=Object(p.a)(f.a.mark((function e(t){var a,s,i,o,j,u,d;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={id:n.id,reviewValue:t},s=(r.rating*r.numReviews+t)/(r.numReviews+1),i=r.numReviews+1,o=r.reviews.filter((function(e){return e.id!==n.id})),console.log(o),console.log(r.reviews),o.length<r.reviews.length&&(j=r.reviews.find((function(e){return e.id===n.id})),s=(s*i-j.reviewValue)/(i-1),i-=1),o.push(a),u=Object(C.a)(Object(C.a)({},r),{},{rating:s,numReviews:i,reviews:o}),e.prev=9,e.next=12,v.a.post("/api/products/update",u);case 12:d=e.sent,c({type:"MODIFY",data:d.data}),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(9),console.log(e.t0);case 19:case"end":return e.stop()}}),e,null,[[9,16]])})));return function(t){return e.apply(this,arguments)}}();"undefined"==typeof r&&a.push("/");var i=function(){var e=Object(p.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c({type:"ADD",data:t});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(w.Link,{className:"btn btn-light my-3 ",to:"/",children:"Go Back"}),Object(d.jsxs)(b.a,{children:[Object(d.jsx)(O.a,{md:6,children:Object(d.jsx)(N.a,{src:r.image,alt:r.name,fluid:!0})}),Object(d.jsx)(O.a,{md:3,children:Object(d.jsxs)(L.a,{variant:"flush",children:[Object(d.jsx)(L.a.Item,{children:Object(d.jsx)("h3",{children:r.name})}),Object(d.jsx)(L.a.Item,{children:Object(d.jsx)(k,{rating:r.rating,numReviews:r.numReviews,reviewFunc:s})}),Object(d.jsxs)(L.a.Item,{children:["Price: $ ",r.price]}),Object(d.jsxs)(L.a.Item,{children:["Description: ",r.description]})]})}),Object(d.jsx)(O.a,{md:3,children:Object(d.jsxs)(g.a,{children:[Object(d.jsx)(L.a,{variant:"flush",children:Object(d.jsx)(L.a.Item,{children:Object(d.jsxs)(b.a,{children:[Object(d.jsx)(O.a,{children:"Price:"}),Object(d.jsx)(O.a,{children:Object(d.jsxs)("strong",{children:[" $",r.price]})})]})})}),Object(d.jsxs)(L.a,{variant:"flush",children:[Object(d.jsx)(L.a.Item,{children:Object(d.jsxs)(b.a,{children:[Object(d.jsx)(O.a,{children:"Status:"}),Object(d.jsx)(O.a,{children:Object(d.jsxs)("strong",{children:["$",r.countInStock>0?"In Stock":"Out of Stock"]})})]})}),Object(d.jsx)(L.a.Item,{children:Object(d.jsx)(q.a,{className:"btn-block",type:"button",disabled:0===r.countInStock,onClick:function(){return i(r)},children:"Add to Cart"})})]})]})})]})]})},P=n(16),_=n(103),G=n(106),E=function(e){var t=e.message;return"loginError"===t?Object(d.jsx)(G.a,{variant:"danger",children:"Invalid Creds!"}):"successfulAdd"===t?Object(d.jsx)(G.a,{variant:"success",children:"Your product has been added!"}):Object(d.jsx)(d.Fragment,{})},R=function(){var e=Object(u.b)(),t=Object(c.useState)(""),n=Object(P.a)(t,2),a=n[0],r=n[1],s=Object(c.useState)(""),i=Object(P.a)(s,2),o=i[0],j=i[1],l=Object(c.useState)(""),b=Object(P.a)(l,2),O=b[0],h=b[1],x=Object(S.k)(),m=function(){var t=Object(p.a)(f.a.mark((function t(){var n,c;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,v.a.post("/users/login",{email:a,password:o});case 3:n=t.sent,window.localStorage.setItem("loggedIn",JSON.stringify(n.data)),c={name:n.data.name,isAdmin:n.data.isAdmin},e({type:"LOGIN",data:c}),x.push("/"),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),h("loginError"),setTimeout((function(){return h("")}),5e3);case 14:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(){return t.apply(this,arguments)}}();return Object(d.jsxs)(_.a,{children:[Object(d.jsx)(E,{message:O}),Object(d.jsxs)(_.a.Group,{controlId:"formBasicEmail",children:[Object(d.jsx)(_.a.Label,{children:"Email address"}),Object(d.jsx)(_.a.Control,{type:"email",placeholder:"Enter email",onChange:function(e){return r(e.target.value)}}),Object(d.jsx)(_.a.Text,{className:"text-muted",children:"We'll never share your email with anyone else."})]}),Object(d.jsxs)(_.a.Group,{controlId:"formBasicPassword",children:[Object(d.jsx)(_.a.Label,{children:"Password"}),Object(d.jsx)(_.a.Control,{type:"password",placeholder:"Password",onChange:function(e){return j(e.target.value)}})]}),Object(d.jsx)(_.a.Group,{controlId:"formBasicCheckbox",children:Object(d.jsx)(_.a.Check,{type:"checkbox",label:"Check me out"})}),Object(d.jsx)(q.a,{variant:"primary",onClick:function(){return m()},children:"Submit"})]})},T=n(63),D=function(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e.cart}));return Object(d.jsxs)(b.a,{children:[Object(d.jsxs)(O.a,{md:8,children:[Object(d.jsx)("h1",{children:"Shopping Cart"}),0===t.length?Object(d.jsxs)(E,{children:["Your cart is empty ",Object(d.jsx)(w.Link,{to:"/",children:"Go Back"})]}):Object(d.jsx)(L.a,{variant:"flush",children:t.map((function(t){return Object(d.jsx)(L.a.Item,{children:Object(d.jsxs)(b.a,{children:[Object(d.jsx)(O.a,{md:2,children:Object(d.jsx)(N.a,{src:t.image,alt:t.name,fluid:!0,rounded:!0})}),Object(d.jsx)(O.a,{md:3,children:Object(d.jsx)(w.Link,{to:"/product/".concat(t.product),children:t.name})}),Object(d.jsxs)(O.a,{md:2,children:["$",t.price]}),Object(d.jsx)(O.a,{md:2,children:Object(d.jsx)(_.a.Control,{as:"select",value:t.qty,onChange:function(n){return e({type:"UPDATE",data:{id:t._id,qty:Number(n.target.value)}})},children:Object(T.a)(Array(t.countInStock).keys()).map((function(e){return Object(d.jsx)("option",{value:e+1,children:e+1},e+1)}))})}),Object(d.jsx)(O.a,{md:2,children:Object(d.jsx)(q.a,{type:"button",variant:"light",onClick:function(){return e({type:"REMOVE",data:t._id})},children:Object(d.jsx)("i",{className:"fas fa-trash"})})})]})},t._id)}))})]}),Object(d.jsx)(O.a,{md:4,children:Object(d.jsx)(g.a,{children:Object(d.jsxs)(L.a,{variant:"flush",children:[Object(d.jsxs)(L.a.Item,{children:[Object(d.jsxs)("h2",{children:["Subtotal (",t.reduce((function(e,t){return e+t.qty}),0),") items"]}),"$",t.reduce((function(e,t){return e+t.qty*t.price}),0).toFixed(2)]}),Object(d.jsx)(L.a.Item,{children:Object(d.jsx)(q.a,{type:"button",className:"btn-block",disabled:!0,children:"Proceed To Checkout"})})]})})})]})},B=function(){var e=Object(c.useState)(""),t=Object(P.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(""),s=Object(P.a)(r,2),i=s[0],o=s[1],j=Object(c.useState)(""),u=Object(P.a)(j,2),l=u[0],h=u[1],x=Object(c.useState)(""),m=Object(P.a)(x,2),g=m[0],k=m[1],w=Object(c.useState)(""),y=Object(P.a)(w,2),I=y[0],C=y[1],N=Object(c.useState)(0),L=Object(P.a)(N,2),A=L[0],G=L[1],R=Object(c.useState)(0),T=Object(P.a)(R,2),D=T[0],B=T[1],F=Object(c.useState)(""),J=Object(P.a)(F,2),V=J[0],$=J[1],M=Object(S.k)(),U=JSON.parse(window.localStorage.getItem("loggedIn"));U.isAdmin||M.push("/");var Y=function(){var e=Object(p.a)(f.a.mark((function e(t){var n,c,a,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.files[0],(c=new FormData).append("image",n),e.prev=3,e.next=6,v.a.post("/api/imgs/imgUpload",c);case 6:a=e.sent,r=a.data,$(r.image),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(p.a)(f.a.mark((function e(t){var n,c,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n={name:i,brand:l,category:g,description:I,price:A,countInStock:D,image:V,user:U.id},e.prev=2,e.next=5,v.a.post("/api/products/addNew",n);case 5:c=e.sent,r=c.data,console.log(r),a("successfulAdd"),setTimeout((function(){return a("")}),15e3),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(E,{message:n}),Object(d.jsxs)(_.a,{action:"#",onSubmit:W,children:[Object(d.jsx)(_.a.Row,{children:Object(d.jsxs)(_.a.Group,{controlId:"ProductName",children:[Object(d.jsx)(_.a.Label,{children:"Product Name:"}),Object(d.jsx)(_.a.Control,{required:!0,onChange:function(e){return o(e.target.value)}})]})}),Object(d.jsxs)(b.a,{children:[Object(d.jsxs)(O.a,{children:[Object(d.jsx)(_.a.Label,{children:"Brand:"}),Object(d.jsx)(_.a.Control,{required:!0,onChange:function(e){return h(e.target.value)}})]}),Object(d.jsxs)(O.a,{children:[Object(d.jsx)(_.a.Label,{children:"Category:"}),Object(d.jsx)(_.a.Control,{required:!0,onChange:function(e){return k(e.target.value)}})]})]}),Object(d.jsxs)(_.a.Group,{controlId:"DescrArea",children:[Object(d.jsx)(_.a.Label,{children:"Description:"}),Object(d.jsx)(_.a.Control,{as:"textarea",rows:3,onChange:function(e){return C(e.target.value)}})]}),Object(d.jsx)(b.a,{}),Object(d.jsxs)(b.a,{children:[Object(d.jsxs)(_.a.Group,{as:O.a,controlId:"formGridPrice",children:[Object(d.jsx)(_.a.Label,{children:"Price:"}),Object(d.jsx)(_.a.Control,{required:!0,onChange:function(e){return G(e.target.value)}})]}),Object(d.jsxs)(_.a.Group,{as:O.a,controlId:"formStock",children:[Object(d.jsx)(_.a.Label,{children:"Count in Stock:"}),Object(d.jsx)(_.a.Control,{required:!0,defaultValue:"1",onChange:function(e){return B(e.target.value)}})]})]}),Object(d.jsxs)(_.a.Group,{controlId:"formFile",className:"mb-3",children:[Object(d.jsx)(_.a.Label,{children:"Product Image"}),Object(d.jsx)(_.a.Control,{type:"file",onChange:Y})]}),Object(d.jsx)(q.a,{type:"submit",children:"Add Product"})]})]})},F=function(){var e=Object(S.k)(),t=JSON.parse(window.localStorage.getItem("loggedIn")).id,n=Object(u.c)((function(e){return e.products.filter((function(e){return e.user===t}))}));0===n.length&&e.push("/");var c=function(){var e=Object(p.a)(f.a.mark((function e(t,n){var c,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n,"$"===t[0]?c.price=Number(t.slice(1)):c.price=Number(t),console.log(c),e.prev=3,e.next=6,v.a.post("/api/products/update",c);case 6:a=e.sent,console.log(a.data),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t,n){return e.apply(this,arguments)}}(),a=function(){var e=Object(p.a)(f.a.mark((function e(t,n){var c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(c=n).countInStock=t,e.prev=2,e.next=5,v.a.post("/api/products/update",c);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(d.jsx)(b.a,{children:Object(d.jsxs)(O.a,{md:12,children:[Object(d.jsx)("h1",{children:"My Products"}),Object(d.jsx)(L.a,{variant:"flush",children:n.map((function(e){return Object(d.jsx)(L.a.Item,{children:Object(d.jsxs)(b.a,{children:[Object(d.jsx)(O.a,{md:2,children:Object(d.jsx)(N.a,{src:e.image,alt:e.name,fluid:!0,rounded:!0})}),Object(d.jsx)(O.a,{md:3,children:Object(d.jsx)(w.Link,{to:"/product/".concat(e.product),children:e.name})}),Object(d.jsx)(O.a,{md:3,children:Object(d.jsx)(_.a.Control,{value:e.qty,defaultValue:"$".concat(e.price),onBlur:function(t){return c(t.target.value,e)}})}),Object(d.jsx)(O.a,{md:3,children:Object(d.jsx)(_.a.Control,{value:e.qty,defaultValue:e.countInStock,onBlur:function(t){return a(t.target.value,e)}})})]})},e._id)}))})]})})};var J=function(){return Object(d.jsx)(w.BrowserRouter,{children:Object(d.jsxs)("div",{className:"App",children:[Object(d.jsx)(l,{}),Object(d.jsx)("main",{className:"py-3",children:Object(d.jsx)(s.a,{children:Object(d.jsxs)(S.g,{children:[Object(d.jsx)(S.d,{path:"/products/:id",component:A}),Object(d.jsx)(S.d,{path:"/login",component:R}),Object(d.jsx)(S.d,{path:"/logout",component:I}),Object(d.jsx)(S.d,{path:"/add",component:B}),Object(d.jsx)(S.d,{path:"/cart",component:D}),Object(d.jsx)(S.d,{path:"/edit",component:F}),Object(d.jsx)(S.d,{path:"/",component:I})]})})}),Object(d.jsx)(h,{})]})})},V=n(44),$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT":return t.data;case"MODIFY":var n=t.data,c=e.filter((function(e){return e._id!==n._id}));return c.concat(n);default:return e}},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return t.data;case"LOGOUT":return{};default:return e}},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD":try{var n=e.find((function(e){return e._id===t.data._id}));return n.qty>0&&n.qty<n.countInStock&&(n.qty+=1),e.filter((function(e){return e._id!==t.data._id})).concat(n)}catch(a){return e.concat(Object(C.a)(Object(C.a)({},t.data),{},{qty:1}))}case"UPDATE":var c=e.find((function(e){return e._id===t.data.id}));return c.qty=t.data.qty,e.filter((function(e){return e._id!==t.data.id})).concat(c);case"REMOVE":return e.filter((function(e){return e.id!==t.data}));case"CLEAR":return[];default:return e}},Y=n(62),W=Object(V.combineReducers)({products:$,user:M,cart:U}),z=Object(V.createStore)(W,Object(Y.composeWithDevTools)());r.a.render(Object(d.jsx)(u.a,{store:z,children:Object(d.jsx)(J,{})}),document.getElementById("root"))}},[[97,1,2]]]);
//# sourceMappingURL=main.cdda9e43.chunk.js.map